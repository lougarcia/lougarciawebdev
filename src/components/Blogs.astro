---
import PageSection from "./PageSection.astro";
import PageSectionHeader from "./PageSectionHeader.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection('posts')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const recentSnippet = posts.find(post => post.data.postType == 'Snippets');
const recentNews = posts.find(post => post.data.postType == 'News');
const recentTutorials = posts.find(post => post.data.postType == 'Tutorials');

const formattedDate = (dateValue:Date) => {
    return new Date(dateValue).toDateString()
}

const items = [recentSnippet, recentNews]
---
<PageSection classes="bg-base-100 max-w-lg mx-auto" id="about">
    <PageSectionHeader class="text-2xl">Blogs</PageSectionHeader>
    <div class="grid gap-4 md:gap-8">
        {items.map((item) => {
            return (
                <div class="rounded-box border border-base-300 px-4 py-3">
                    <div class="font-semibold">
                        {item?.data.title}
                    </div>
                    <div class="text-xs opacity-80 tabular-nums">
                        {formattedDate(item?.data.pubDate as Date)}
                    </div>
                    <div class="text-sm opacity-80 mt-4">
                        {item?.data.summary}
                    </div>
                    <div class="mt-2">
                        <a href={item?.data.slug} class="text-sm flex gap-1 items-center" target="_blank" aria-label={`Read more about ${item?.data.title}`}>
                            Read more
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 3h6v6m-11 5L21 3m-3 10v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/></svg>
                        </a>
                    </div>
                </div>
            )
        })}
    </div>
</PageSection>